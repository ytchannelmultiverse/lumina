<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LUMINA MESSENGER - PITCH BLACK</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #000000; }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        .scrollbar-none::-webkit-scrollbar { display: none; }
        /* Animation Utility */
        .animate-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo, useCallback } = React;
        
        // Mocking Lucide Icons since they are loaded via script tag
        const { 
            Send, Paperclip, Smile, Search, MoreVertical, Check, CheckCheck, 
            ChevronLeft, Phone, Video, Info, User, Users, Megaphone, 
            Shield, Settings, Moon, Sun, Trash2, Edit3, Reply, MessageSquare,
            Mic, Image: ImageIcon, File, Play, Pause, X, Pin, CornerUpRight,
            SmilePlus, BarChart2, BellOff, Lock, Hash, ArrowRight, Globe, 
            Zap, Github, Twitter, Menu, Cpu, ShieldCheck, Database, Layers,
            Terminal, Share2, Volume2, Eye, EyeOff, Key, Monitor, Smartphone,
            Activity, LifeBuoy, Heart
        } = lucide;

        // --- Constants & Enhanced Mock Data ---
        const CURRENT_USER_MOCK = {
            id: 'u-1',
            username: 'alex_dev',
            name: 'Alex Rivera',
            avatar: 'https://i.pravatar.cc/150?u=u-1',
            bio: 'Lead Architect @ Lumina. Engineering for privacy.',
            presence: 'online',
            phone: '+1 (555) 0123'
        };

        const INITIAL_CHATS = [
            {
                id: 'c-1',
                type: 'dm',
                name: 'Sarah Chen',
                avatar: 'https://i.pravatar.cc/150?u=u-2',
                lastMessage: 'The encryption keys are rotated.',
                timestamp: '10:42 AM',
                unreadCount: 2,
                online: true,
                isE2EE: true,
                bio: 'Product Designer | Cryptography enthusiast'
            },
            {
                id: 'c-2',
                type: 'group',
                name: 'Core Architecture',
                avatar: 'https://i.pravatar.cc/150?u=g-1',
                lastMessage: 'James: Let\'s shard the ScyllaDB cluster.',
                timestamp: '9:15 AM',
                unreadCount: 0,
                members: 42,
                isPinned: true,
                isMuted: true
            },
            {
                id: 'c-3',
                type: 'channel',
                name: 'Lumina Global News',
                avatar: 'https://i.pravatar.cc/150?u=ch-1',
                lastMessage: 'Version 3.0 is now live in all regions!',
                timestamp: 'Yesterday',
                unreadCount: 0,
                subscribers: '1.2M'
            }
        ];

        const MOCK_MESSAGES = {
            'c-1': [
                { id: 'm-1', senderId: 'u-2', text: 'Hey, did you review the whitepaper?', timestamp: '10:30 AM', status: 'read' },
                { id: 'm-2', senderId: 'u-1', text: 'Just finished. The zero-knowledge proof implementation looks solid.', timestamp: '10:32 AM', status: 'read' },
                { id: 'm-3', senderId: 'u-2', text: 'The encryption keys are rotated.', timestamp: '10:42 AM', status: 'delivered', reactions: [{ emoji: 'ðŸš€', count: 1 }] },
            ],
            'c-2': [
                { id: 'g-1', senderId: 'u-5', text: 'Current write latency is < 5ms.', timestamp: '9:00 AM', status: 'read' },
                { id: 'g-2', senderId: 'u-1', text: 'Perfect. Roll out the next sharding layer.', timestamp: '9:15 AM', status: 'read' }
            ]
        };

        // --- Landing Page Component ---
        const LandingPage = ({ onGetStarted }) => {
            const [scrolled, setScrolled] = useState(false);
            
            useEffect(() => {
                const handleScroll = () => setScrolled(window.scrollY > 20);
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            return (
                <div className="min-h-screen bg-black text-white font-sans">
                    <nav className={`fixed top-0 w-full z-50 transition-all duration-300 ${scrolled ? 'bg-black/80 backdrop-blur-xl border-b border-white/10 py-4' : 'bg-transparent py-6'}`}>
                        <div className="max-w-7xl mx-auto px-6 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-indigo-500/20">
                                    <Shield size={24} />
                                </div>
                                <span className="text-2xl font-black tracking-tighter">LUMINA</span>
                            </div>
                            <div className="hidden lg:flex items-center gap-10 text-slate-500 font-bold text-sm uppercase tracking-widest">
                                <a href="#protocol" className="hover:text-white transition-colors">Protocol</a>
                                <a href="#infra" className="hover:text-white transition-colors">Infrastructure</a>
                                <a href="#dev" className="hover:text-white transition-colors">Developers</a>
                                <a href="#security" className="hover:text-white transition-colors">Security</a>
                            </div>
                            <button onClick={onGetStarted} className="bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2.5 rounded-full font-bold transition-all shadow-lg shadow-indigo-500/20">
                                Get Started
                            </button>
                        </div>
                    </nav>

                    <section className="relative pt-40 pb-32 px-6 overflow-hidden">
                        <div className="absolute top-0 left-1/2 -translate-x-1/2 w-full h-[800px] bg-gradient-to-b from-indigo-500/10 to-transparent blur-[120px]" />
                        <div className="max-w-7xl mx-auto text-center relative z-10">
                            <div className="inline-flex items-center gap-2 px-4 py-1.5 bg-indigo-500/10 border border-indigo-500/20 rounded-full text-indigo-400 text-xs font-black uppercase tracking-widest mb-8">
                                <Zap size={14} className="fill-current" /> Enterprise Ready
                            </div>
                            <h1 className="text-6xl md:text-8xl font-black tracking-tighter mb-8 leading-[0.9]">
                                The New Standard for <br />
                                <span className="bg-gradient-to-r from-indigo-400 via-white to-indigo-400 bg-clip-text text-transparent">Global Messaging.</span>
                            </h1>
                            <p className="text-xl md:text-2xl text-slate-400 max-w-3xl mx-auto mb-12 leading-relaxed">
                                Engineered for performance. Built for privacy. A clean-room implementation of a massive-scale real-time ecosystem.
                            </p>
                            <div className="flex flex-col sm:flex-row items-center justify-center gap-6">
                                <button onClick={onGetStarted} className="w-full sm:w-auto px-10 py-5 bg-white text-black rounded-2xl font-black text-xl hover:scale-105 transition-all shadow-2xl flex items-center justify-center gap-3">
                                    Open Web Terminal <ArrowRight />
                                </button>
                                <div className="flex items-center gap-4 text-slate-500 font-bold">
                                    <span className="flex items-center gap-1"><ShieldCheck size={18} /> E2EE</span>
                                    <span className="w-1.5 h-1.5 rounded-full bg-slate-800" />
                                    <span className="flex items-center gap-1"><Globe size={18} /> Edge-Sync</span>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };

        // --- Auth flow ---
        const AuthFlow = ({ onAuthComplete }) => {
            const [step, setStep] = useState('phone');
            const [loading, setLoading] = useState(false);

            const handleSubmit = (e) => {
                e.preventDefault();
                setLoading(true);
                setTimeout(() => {
                    setLoading(false);
                    if (step === 'phone') setStep('otp');
                    else onAuthComplete(CURRENT_USER_MOCK);
                }, 1500);
            };

            return (
                <div className="min-h-screen bg-black flex items-center justify-center p-6">
                    <div className="w-full max-w-md bg-black border border-white/10 rounded-[2.5rem] p-10 shadow-3xl text-white">
                        <div className="text-center mb-10">
                            <div className="w-20 h-20 bg-indigo-600 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-2xl shadow-indigo-500/20">
                                <Shield size={40} />
                            </div>
                            <h2 className="text-3xl font-black mb-2">Initialize Session</h2>
                            <p className="text-slate-500 font-medium">Authentication via Lumina-Auth gateway.</p>
                        </div>
                        <form onSubmit={handleSubmit} className="space-y-8">
                            {step === 'phone' ? (
                                <div className="space-y-4">
                                    <label className="text-xs font-black uppercase tracking-widest text-slate-500 ml-1">Phone Number</label>
                                    <div className="flex gap-3">
                                        <div className="px-5 py-4 bg-white/5 border border-white/10 rounded-2xl font-black">+1</div>
                                        <input type="tel" placeholder="555-0123" required autoFocus className="flex-1 px-5 py-4 bg-white/5 border border-white/10 rounded-2xl outline-none focus:border-indigo-600 transition-all text-lg font-bold text-white" />
                                    </div>
                                </div>
                            ) : (
                                <div className="space-y-4">
                                    <label className="text-xs font-black uppercase tracking-widest text-slate-500 ml-1">Enter OTP Code</label>
                                    <div className="flex justify-between gap-3">
                                        {[1,2,3,4,5].map(i => (
                                            <input key={i} type="text" maxLength="1" required className="w-full h-16 bg-white/5 border border-white/10 rounded-2xl text-center text-2xl font-black outline-none focus:border-indigo-600 text-white" />
                                        ))}
                                    </div>
                                </div>
                            )}
                            <button disabled={loading} className="w-full py-5 bg-indigo-600 hover:bg-indigo-500 disabled:bg-white/5 rounded-2xl font-black text-xl transition-all shadow-xl shadow-indigo-500/20">
                                {loading ? 'Processing...' : 'Secure Login'}
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        const Avatar = ({ src, name, size = 'md', online = false }) => {
            const sizeClasses = { sm: 'w-8 h-8 text-xs', md: 'w-12 h-12 text-sm', lg: 'w-16 h-16 text-base', xl: 'w-24 h-24 text-lg' };
            return (
                <div className={`relative flex-shrink-0 ${sizeClasses[size]}`}>
                    {src ? <img src={src} alt={name} className="w-full h-full rounded-full object-cover border border-slate-100 dark:border-white/10" /> : 
                        <div className="w-full h-full rounded-full bg-indigo-500 flex items-center justify-center text-white font-black">{name.charAt(0)}</div>}
                    {online && <div className="absolute bottom-1 right-1 w-3 h-3 bg-green-500 border-2 border-white dark:border-black rounded-full" />}
                </div>
            );
        };

        const SettingsView = ({ onClose, isDarkMode, setIsDarkMode }) => (
            <div className="absolute inset-0 bg-white dark:bg-black z-50 flex flex-col animate-in">
                <header className="h-16 flex items-center px-4 border-b dark:border-white/10 gap-4">
                    <button onClick={onClose} className="p-2 text-slate-500 hover:bg-slate-100 dark:hover:bg-white/5 rounded-full"><ChevronLeft size={24} /></button>
                    <h2 className="text-lg font-bold dark:text-white">Settings</h2>
                </header>
                <div className="flex-1 p-6 space-y-6 overflow-y-auto">
                    <div className="flex items-center gap-4 p-4 bg-slate-50 dark:bg-white/5 rounded-2xl">
                        <Avatar src={CURRENT_USER_MOCK.avatar} name={CURRENT_USER_MOCK.name} size="lg" />
                        <div><h3 className="font-bold dark:text-white">{CURRENT_USER_MOCK.name}</h3><p className="text-sm text-slate-500">@{CURRENT_USER_MOCK.username}</p></div>
                    </div>
                    <div className="flex items-center justify-between p-4 border dark:border-white/10 rounded-2xl">
                        <div className="flex items-center gap-3 dark:text-white">{isDarkMode ? <Moon size={20}/> : <Sun size={20}/>} <span>Dark Mode</span></div>
                        <button onClick={() => setIsDarkMode(!isDarkMode)} className={`w-12 h-6 rounded-full relative transition-colors ${isDarkMode ? 'bg-indigo-600' : 'bg-slate-300'}`}>
                            <div className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-all ${isDarkMode ? 'left-7' : 'left-1'}`} />
                        </button>
                    </div>
                </div>
            </div>
        );

        function App() {
            const [view, setView] = useState('landing'); 
            const [currentUser, setCurrentUser] = useState(null);
            const [activeChat, setActiveChat] = useState(INITIAL_CHATS[0]);
            const [messages, setMessages] = useState(MOCK_MESSAGES);
            const [inputText, setInputText] = useState('');
            const [isDarkMode, setIsDarkMode] = useState(true);
            const [searchQuery, setSearchQuery] = useState('');
            const [showSettings, setShowSettings] = useState(false);
            const [replyingTo, setReplyingTo] = useState(null);
            
            const scrollRef = useRef(null);
            useEffect(() => { if (scrollRef.current) scrollRef.current.scrollTop = scrollRef.current.scrollHeight; }, [messages, activeChat]);

            const handleSendMessage = (e) => {
                e?.preventDefault();
                if (!inputText.trim()) return;
                const newMessage = {
                    id: `m-${Date.now()}`,
                    senderId: currentUser.id,
                    text: inputText,
                    timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                    status: 'sent',
                    replyTo: replyingTo?.text || null
                };
                setMessages(prev => ({ ...prev, [activeChat.id]: [...(prev[activeChat.id] || []), newMessage] }));
                setInputText('');
                setReplyingTo(null);
            };

            if (view === 'landing') return <LandingPage onGetStarted={() => setView('auth')} />;
            if (view === 'auth') return <AuthFlow onAuthComplete={(u) => { setCurrentUser(u); setView('app'); }} />;

            return (
                <div className={`flex h-screen w-full overflow-hidden ${isDarkMode ? 'dark bg-black' : 'bg-slate-50'}`}>
                    <aside className="hidden md:flex flex-col w-20 bg-white dark:bg-black border-r dark:border-white/10 items-center py-8 gap-10">
                        <div className="w-12 h-12 bg-indigo-600 rounded-2xl flex items-center justify-center text-white"><Shield size={24} /></div>
                        <button onClick={() => setShowSettings(true)} className="text-slate-400 hover:text-indigo-500 mt-auto"><Settings size={26} /></button>
                        <Avatar src={currentUser?.avatar} name={currentUser?.name} size="sm" online />
                    </aside>

                    <div className="w-full md:w-80 lg:w-[22rem] flex flex-col bg-white dark:bg-black border-r dark:border-white/10">
                        <div className="p-6"><h1 className="text-2xl font-black dark:text-white mb-4">Chats</h1>
                            <input type="text" placeholder="Search..." className="w-full p-3 bg-slate-50 dark:bg-white/5 rounded-xl dark:text-white outline-none" onChange={e => setSearchQuery(e.target.value)} />
                        </div>
                        <div className="flex-1 overflow-y-auto px-2 custom-scrollbar">
                            {INITIAL_CHATS.filter(c => c.name.toLowerCase().includes(searchQuery.toLowerCase())).map(chat => (
                                <div key={chat.id} onClick={() => setActiveChat(chat)} className={`flex items-center gap-4 p-4 rounded-3xl cursor-pointer ${activeChat.id === chat.id ? 'bg-indigo-600/10' : ''}`}>
                                    <Avatar src={chat.avatar} name={chat.name} online={chat.online} />
                                    <div className="flex-1 min-w-0"><div className="flex justify-between"><span className="font-bold dark:text-white truncate">{chat.name}</span><span className="text-[10px] text-slate-400">{chat.timestamp}</span></div><p className="text-sm text-slate-500 truncate">{chat.lastMessage}</p></div>
                                </div>
                            ))}
                        </div>
                        {showSettings && <SettingsView onClose={() => setShowSettings(false)} isDarkMode={isDarkMode} setIsDarkMode={setIsDarkMode} />}
                    </div>

                    <main className="flex-1 flex flex-col relative">
                        <header className="h-16 flex items-center justify-between px-6 border-b dark:border-white/10 bg-white/80 dark:bg-black/80 backdrop-blur-xl">
                            <div className="flex items-center gap-3"><Avatar src={activeChat.avatar} name={activeChat.name} size="sm" online={activeChat.online} /><h2 className="font-black dark:text-white">{activeChat.name}</h2></div>
                        </header>
                        <div ref={scrollRef} className="flex-1 overflow-y-auto p-6 space-y-4 custom-scrollbar">
                            {(messages[activeChat.id] || []).map(msg => (
                                <div key={msg.id} className={`flex ${msg.senderId === currentUser.id ? 'justify-end' : 'justify-start'}`}>
                                    <div className={`max-w-[70%] p-4 rounded-3xl ${msg.senderId === currentUser.id ? 'bg-indigo-600 text-white' : 'bg-white dark:bg-white/10 dark:text-white border dark:border-white/5'}`}>
                                        {msg.replyTo && <div className="text-[10px] opacity-70 mb-1 italic border-l-2 pl-2 border-white/50">Replying to: {msg.replyTo}</div>}
                                        {msg.text}
                                    </div>
                                </div>
                            ))}
                        </div>
                        <footer className="p-6">
                            <form onSubmit={handleSendMessage} className="flex items-center gap-3 bg-white dark:bg-white/5 p-3 rounded-2xl border dark:border-white/10">
                                <button type="button" className="text-slate-400"><Paperclip/></button>
                                <input type="text" className="flex-1 bg-transparent dark:text-white outline-none" placeholder="Type a message..." value={inputText} onChange={e => setInputText(e.target.value)} />
                                <button className="p-2 bg-indigo-600 rounded-xl text-white"><Send size={20}/></button>
                            </form>
                        </footer>
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
